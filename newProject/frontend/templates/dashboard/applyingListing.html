{% extends "dashboard/layout.html" %}
{% block content %}

<div class="dashboardHome">
  <div class="inner">
    <div class="top d-flex align-items-center justify-content-between">
      <p class="m-0 title">All Applying List</p>
    </div>

    <hr>

    <table class="table table-striped table-bordered">
      <thead>
        <tr>
          <th>#</th>
          <th>Photo ID</th>
          <th>Property ID</th>
          <th>Move In Date</th>
          <th>Applicant Type</th>
          <th>Name</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Submitted At</th>
          <th>Actions</th>
        </tr>
      </thead>

      <tbody>
        {% for app in applications %}
        <tr>
          <td>{{ forloop.counter }}</td>

          <td>
            {% if app.photo_id %}
              <a href="{{ app.photo_id.url }}" target="_blank">
      <img 
        src="{{ app.photo_id.url }}" 
        alt="Photo ID" 
        style="width:80px; height:80px; object-fit:cover; border-radius:4px;"
      >
    </a>
            {% else %}
              N/A
            {% endif %}
          </td>

          <td>{{ app.property_id }}</td>
          <td>{{ app.move_in_date }}</td>
          <td>{{ app.applicant_type|title }}</td>
          <td>{{ app.first_name }} {{ app.last_name }}</td>
          <td>{{ app.email }}</td>
          <td>{{ app.phone }}</td>
          <td>{{ app.submitted_at|date:"Y-m-d" }}</td>

          <td>
            <a href="{% url 'application_view' app.id %}" class="btn btn-sm btn-primary">View</a>
            <a href="{% url 'edit_applying' app.id %}" class="btn btn-sm btn-primary">Edit</a>
            <a href="{% url 'application_delete' app.id %}" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure you want to delete this application?');">Delete</a>

          </td>
        </tr>

        {% empty %}
        <tr>
          <td colspan="10" class="text-center">No applications found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

  </div>
</div>

{% endblock %}
